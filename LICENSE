Copyright 2010, Daniel DeLeo <dan@kallistec.com>
Code provided under the Apache 2.0 license, but I'm too lazy to copy that here
at the moment.